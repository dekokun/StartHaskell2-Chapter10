# 関数型問題解決法

## 自己紹介

## 逆ポーランド記法電卓

### 逆ポーランド記法(RPN)とは

### RPN関数を作成する

#### アイテムのリストに分割

* words

#### 畳込み

* 今回はリストを左から右へ操作するため、左畳込み
* foldl

#### スタックはリストとして表現

* リストの先頭をスタックの先頭に対応
* 先頭の要素の出し入れは末尾よりもずっと高速
* 10, 4, 3というスタックは[3,4,10]というリストとして表現

#### 関数の一部

<pre><code>
solveRPN :: String -> Double
solveRPN expression = head (foldl foldingFunction [] (words expression))
  where foldingFunction stack item = ....
</code></pre>

* ポイントフリースタイルで書きなおす

<pre><code>
solveRPN :: String -> Double
solveRPN = head . foldl foldingFunction [] . words
  where foldingFunction stack item = ....
</code></pre>

#### 畳み込みを行う関数の作成

<pre><code>
solveRPN :: String -> Double
solveRPN = head . foldl foldingFunction [] . words
  where foldingFunction (x:y:ys) "*" = (y * x):ys
        foldingFunction (x:y:ys) "+" = (y + x):ys
        foldingFunction (x:y:ys) "-" = (y - x):ys
        foldingFunction xs numberString = read numberString:xs
</code></pre>

##### 解説

<pre><code>
foldingFunction (x:y:ys) "*" = (y * x):ys
</pre></code>

* foldingFunction "*" [3,5,7,9]の場合、x -> 3, y-> 5, ys-> [7,9]で、(3 * 5):[7,9]->[15,7,9]が返される
* "+","-"の時も同様
* 上記のどれでもなかった場合、演算子ではないため数だと考えられるためreadを適用し中身を実数に変換しその数をスタックに積んで返す

##### 例

["2","3,"+""]の例

### 拡張

"/"とか"^"とか

拡張が用意すぎてやばい

### 失敗する場合

14章でMaybeモナドを使いましょう

## ヒースロー空港からロンドンへ


